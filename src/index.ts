import { app, BrowserWindow, Menu, nativeImage, Tray } from 'electron';
import buildStorageHandlers from './handlers/local-storage.handler';
// This allows TypeScript to pick up the magic constants that's auto-generated by Forge's Webpack
// plugin that tells the Electron app where to look for the Webpack-bundled app code (depending on
// whether you're running in development or production).
declare const MAIN_WINDOW_WEBPACK_ENTRY: string;
declare const MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY: string;

// Handle creating/removing shortcuts on Windows when installing/uninstalling.
if (require('electron-squirrel-startup')) {
  app.quit();
}

let tray;
let editorWindow: BrowserWindow;
let crosshairWindow: BrowserWindow;

const createEditorWindow = (): void => {
  editorWindow = new BrowserWindow({
    height: 600,
    width: 800,
    webPreferences: {
      preload: MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY
    },
    autoHideMenuBar: true
  });
  editorWindow.setMenu(null);

  editorWindow.on('close', (e) => {
    e.preventDefault();
    editorWindow.hide();
  });

  // Load the index.html of the app.
  editorWindow.loadURL(MAIN_WINDOW_WEBPACK_ENTRY);

  editorWindow.webContents.openDevTools();
};

const createCrosshairWindow = () => {
  crosshairWindow = new BrowserWindow({
    height: 600,
    width: 800,
    webPreferences: {
      preload: MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY
    },
    autoHideMenuBar: true,
    frame: false,
    transparent: true,
    focusable: false,
    resizable: false,
    fullscreenable: false
  });
  crosshairWindow.setMenu(null);
  crosshairWindow.setIgnoreMouseEvents(true);
  crosshairWindow.setAlwaysOnTop(true, 'screen-saver');
  crosshairWindow.setSkipTaskbar(true);

  // Load the index.html of the app.
  crosshairWindow.loadURL(MAIN_WINDOW_WEBPACK_ENTRY);
};

const toggleWindow = (window: BrowserWindow): void => {
  window.isVisible() ? window.hide() : window.show();
};

const focusWindow = (window: BrowserWindow): void => {
  window.show();
  window.focus();
};

const quitApp = (): void => {
  editorWindow.destroy(); 
  crosshairWindow.destroy(); 
  app.quit();
};

const createTray = (): void => {
  //#region Tray Icon
  const trayIcon = nativeImage.createFromDataURL('data:image/jpeg;base64,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');
  //#endregion
  tray = new Tray(trayIcon);

  const contextMenu = Menu.buildFromTemplate([
    { label: 'Open Editor', click: () => focusWindow(editorWindow) },
    { label: 'Toggle Crosshair', click: () => toggleWindow(crosshairWindow) },
    { label: 'Quit', click: quitApp }
  ]);

  tray.setContextMenu(contextMenu);
  tray.setToolTip('Crosshare');
};

app.on('ready', () => {
  createEditorWindow();
  createCrosshairWindow();
  createTray();
});

app.on('window-all-closed', () => {
    app.quit();
});

buildStorageHandlers();